<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.1.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.1.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.1.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.1.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.1.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '6.1.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="工作室内部论坛FlyingForum
为什么使用nodebb
工作室需要一个论坛，交流平台作为QQ群的补充，以及需要一个收集反馈的地方等。
之前想使用原来的discuz，通过模板开发之后再重新推广。但开发失败
暑假接触到开源软件的概念，并在自己的服务器上部署了一两个开源服务:Ghost，nodebb等。
nodebb好看以及响应式设计，移动友好性等">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux下部署开源论坛Nodebb">
<meta property="og:url" content="http://blog.seventeams.cn/2017/01/01/Linux下部署开源论坛Nodebb/index.html">
<meta property="og:site_name" content="seventeams">
<meta property="og:description" content="工作室内部论坛FlyingForum
为什么使用nodebb
工作室需要一个论坛，交流平台作为QQ群的补充，以及需要一个收集反馈的地方等。
之前想使用原来的discuz，通过模板开发之后再重新推广。但开发失败
暑假接触到开源软件的概念，并在自己的服务器上部署了一两个开源服务:Ghost，nodebb等。
nodebb好看以及响应式设计，移动友好性等">
<meta property="og:updated_time" content="2017-03-26T03:11:51.147Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Linux下部署开源论坛Nodebb">
<meta name="twitter:description" content="工作室内部论坛FlyingForum
为什么使用nodebb
工作室需要一个论坛，交流平台作为QQ群的补充，以及需要一个收集反馈的地方等。
之前想使用原来的discuz，通过模板开发之后再重新推广。但开发失败
暑假接触到开源软件的概念，并在自己的服务器上部署了一两个开源服务:Ghost，nodebb等。
nodebb好看以及响应式设计，移动友好性等">



  <link rel="alternate" href="/rss2.xml" title="seventeams" type="application/atom+xml" />




  <link rel="canonical" href="http://blog.seventeams.cn/2017/01/01/Linux下部署开源论坛Nodebb/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Linux下部署开源论坛Nodebb | seventeams</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> 

<div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">seventeams</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">seven，seventeen，seventeam</p>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        
          
  
  <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页</a>
</li>

      
        
        
          
  
  <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />归档</a>
</li>

      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />搜索</a>
        </li>
      
    </ul>
  

  
    

    
    
      
      
    
      
      
    
    

  


  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>


  



 </div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.seventeams.cn/2017/01/01/Linux下部署开源论坛Nodebb/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="seven-zsyzzx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="seventeams">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Linux下部署开源论坛Nodebb</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-01-01T21:57:13+08:00">2017-01-01</time>
            

            
            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/01/01/Linux下部署开源论坛Nodebb/" class="leancloud_visitors" data-flag-title="Linux下部署开源论坛Nodebb">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数：</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="工作室内部论坛FlyingForum"><a href="#工作室内部论坛FlyingForum" class="headerlink" title="工作室内部论坛FlyingForum"></a><a href="http://forum.flyingstudio.online/" target="_blank" rel="external">工作室内部论坛FlyingForum</a></h1><hr>
<h1 id="为什么使用nodebb"><a href="#为什么使用nodebb" class="headerlink" title="为什么使用nodebb"></a>为什么使用nodebb</h1><ol>
<li>工作室需要一个论坛，交流平台作为QQ群的补充，以及需要一个收集反馈的地方等。</li>
<li>之前想使用原来的discuz，通过模板开发之后再重新推广。但开发失败</li>
<li>暑假接触到开源软件的概念，并在自己的服务器上部署了一两个开源服务:Ghost，nodebb等。</li>
<li>nodebb好看以及响应式设计，移动友好性等</li>
</ol>
<a id="more"></a>
<h1 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h1><ul>
<li><h3 id="安装Node"><a href="#安装Node" class="headerlink" title="安装Node"></a>安装Node</h3><p>参照肖神的安装方法，使用包管理器安装：<a href="https://nodejs.org/en/download/package-manager/" target="_blank" rel="external">Nodejs官方包管理器安装方法</a></p>
<blockquote>
<p>少了很多配置，能否安装成功全看网速了（学校的校内网对国外的网速限制特别厉害）<br>附上<a href="http://blog.xgy666.cn/" target="_blank" rel="external">肖神博客</a></p>
</blockquote>
</li>
<li><h3 id="安装Nginx"><a href="#安装Nginx" class="headerlink" title="安装Nginx"></a>安装Nginx</h3><p>为了使用最新版的Nginx，参照[官方的下载安装教程] (<a href="http://nginx.org/en/linux_packages.html#stable" target="_blank" rel="external">http://nginx.org/en/linux_packages.html#stable</a>) 找到相应的系统版本下载就行</p>
</li>
<li><h3 id="安装Git-root下yum安装"><a href="#安装Git-root下yum安装" class="headerlink" title="安装Git root下yum安装"></a>安装Git <em>root下yum安装</em></h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yum <span class="keyword">install</span> git</div></pre></td></tr></table></figure>
</li>
<li><h3 id="安装redis3-2-6"><a href="#安装redis3-2-6" class="headerlink" title="安装redis3.2.6"></a>安装redis3.2.6</h3><blockquote>
<p>原本考虑使用mongodb的，但下载速度太慢、也比较大200+M及莫名失败，所以选择了redis，<br>附上<a href="https://docs.mongodb.com/manual/tutorial/install-mongodb-on-red-hat/" target="_blank" rel="external">mongodb”centos”官方安装教程</a></p>
</blockquote>
<ol>
<li><p>下载Redis参考<a href="https://redis.io/download" target="_blank" rel="external">官方下载教程</a></p>
<blockquote>
<p>我实在受不了学校的下载速度，所以是先下载到本地，然后通过‘FileZilla’上传到服务器<strong>源代码只有不到2MB！</strong></p>
</blockquote>
</li>
<li><p>设置redis</p>
<blockquote>
<ul>
<li><a href="https://linux.cn/article-6719-1.html" target="_blank" rel="external">CentOS 7 上安装 Redis 服务器</a>  </li>
<li><a href="https://segmentfault.com/a/1190000002685224" target="_blank" rel="external">centos6安装redis</a></li>
</ul>
</blockquote>
</li>
</ol>
</li>
</ul>
<p>预想到学校的网速问题，在使用这个方法之前，尝试过使用<a href="http://mirrors.ustc.edu.cn/" target="_blank" rel="external">中科大镜像</a>的<a href="http://blog.chinaunix.net/uid-2469966-id-3916408.html" target="_blank" rel="external">EPEL</a>。使用<code>yum install redis</code>来安装redis，这样安装真的少了很多手动配置，方便很多。<br>但是中科大centos6的EPEL很久没更新了（最近更新在2010年左右）,导致Redis版本太低，nodebb启动失败，最后采用了上述手动安装的方法</p>
<hr>
<h1 id="开始安装Nodebb"><a href="#开始安装Nodebb" class="headerlink" title="开始安装Nodebb"></a>开始安装Nodebb</h1><h3 id="1-下载Nodebb到相应的目录"><a href="#1-下载Nodebb到相应的目录" class="headerlink" title="1.  下载Nodebb到相应的目录"></a>1.  下载Nodebb到相应的目录</h3><p><code>git clone https://github.com/NodeBB/NodeBB.git</code></p>
<h3 id="2-参照官方教程安装NodeBB"><a href="#2-参照官方教程安装NodeBB" class="headerlink" title="2. 参照官方教程安装NodeBB"></a>2. 参照<a href="https://docs.nodebb.org/en/latest/installing/os/centos.html" target="_blank" rel="external">官方教程</a>安装NodeBB</h3><blockquote>
<p>如果<code>npm install</code> 速度比较慢的话，可以使用淘宝的国内镜像<br><code>npm install --registry=https://registry.npm.taobao.org</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">//安装依赖包</div><div class="line">npm install</div><div class="line">//配置nodebb 管理员，数据库等</div><div class="line">./nodebb setup</div></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="3-安装完成后，启动NodeBB"><a href="#3-安装完成后，启动NodeBB" class="headerlink" title="3. 安装完成后，启动NodeBB"></a>3. 安装完成后，启动NodeBB</h3><p>在nodebb的根目录下<br>终端执行 <code>./nodebb start</code>或者<code>node app</code></p>
<blockquote>
<ul>
<li>前者是只要服务器不关机就可以一直后台运行</li>
<li>后者必须保持终端打开状态，终端一断开或者一按‘CTRL+C’,nodebb就会停止，而且后者会显示启动状态及启动失败问题</li>
</ul>
</blockquote>
<p>运行成功后，可以通过你设置的端口号来访问了，在nodebb根目录‘config.js’文件修改</p>
<blockquote>
<ul>
<li>本地  <a href="http://localhost:你的端口号（默认4567）" target="_blank" rel="external">http://localhost:你的端口号（默认4567）</a> 如果是服务器没有图形界面可以使用  <code>curl i localhost:4567</code> 来检验nodebb是否启动成功</li>
<li>外网访问 <a href="http://你的Ip地址:端口（默认4567）这个前提是：你要开放相应的端口" target="_blank" rel="external">http://你的Ip地址:端口（默认4567）这个前提是：你要开放相应的端口</a></li>
</ul>
</blockquote>
<h3 id="4-设置nginx"><a href="#4-设置nginx" class="headerlink" title="4. 设置nginx"></a>4. 设置nginx</h3><p>参照<a href="https://docs.nodebb.org/en/latest/configuring/proxies/nginx.html" target="_blank" rel="external">Nodebb官方Nginx配置</a></p>
<blockquote>
<p><strong>设置nginx的目的是只开放80端口，不用开放所有端口，就可以访问一个服务器里的多个网站，更方便和更安全</strong><br>更多资料,Nginx相关。请百度“Nginx” 或者看<a href="http://wiki.flyingstudio.online/" target="_blank" rel="external">工作室wiki</a></p>
</blockquote>
<hr>
<h1 id="问题解决-SElinux导致Nginx转发失败"><a href="#问题解决-SElinux导致Nginx转发失败" class="headerlink" title="问题解决  SElinux导致Nginx转发失败"></a>问题解决  SElinux导致Nginx转发失败</h1><p>做完上述工作后，根据我在自己的腾讯云服务器配置nodebb的经验，是可以通过域名访问的 <a href="http://forum.flyingstudio.online/" target="_blank" rel="external">http://forum.flyingstudio.online/</a> ，但这次出现了“502”错误。</p>
<p>刚开始还以为Nginx配置错误，又重复弄了几次：配置文件名字 *.conf，默认配置文件中是否 include 了配置文件夹，配置文件的内容等</p>
<p>最后只好百度关键词“502” “nodebb 启动” “nodebb 502”等。，找到了读取nginx日志的命令：<br><code>sudo tail /var/log/nginx/error.log</code></p>
<p>在日志中发现了原因：这是部分关键字“failed (13: Permission denied)”  百度了之后发现是：SeLinux设置问题。<a href="http://www.hpboys.com/827.html" target="_blank" rel="external">搜到的结果</a></p>
<p>然后我尝试了 <code>setenforce 0</code> 临时设置Selinux为Permissive,域名访问nodebb后，发现没有出现，所以问题解决成功</p>
<p>为了安全考虑，我又把selinux设置为“Enforcing”，想着能不能只开放一个端口即nodebb使用的端口（默认4567），想起<a href="https://docs.mongodb.com/manual/tutorial/install-mongodb-on-red-hat/" target="_blank" rel="external">安装mongodb</a>曾经提到过selinux<br>在里面找到:</p>
<blockquote>
<p>If SELinux is in enforcing mode, enable access to the relevant ports that the MongoDB deployment will use (e.g. 27017). See Default MongoDB Port for more information on MongoDB’s default ports. For default settings, this can be accomplished by running<br><code>semanage port -a -t mongod_port_t -p tcp 27017</code></p>
</blockquote>
<p>仿照搜到的教程<a href="http://os.51cto.com/art/201105/265956.htm" target="_blank" rel="external">selinux教程</a>里Apache的解决方法</p>
<blockquote>
<p>可以看出 SELinux 根据三种不同情况分别给出了对应的解决方法。在这里，第一种情况是我们想要的，于是按照其建议输入：<br><code>semanage port -a -t http_port_t -p tcp 888</code><br>之后再次启动 Apache 服务就不会有问题了。<br>这里又可以见到 semanage 这个 SELinux 管理配置工具。它第一个选项代表要更改的类型，然后紧跟所要进行操作。</p>
</blockquote>
<p>最后写了这个命令:<code>semanage port -a -t http_port_t -p tcp 4567</code>，nodebb能通过域名访问了</p>
<blockquote>
<p>期间出现了没有找到”semanage”问题，找到的解决方案有：</p>
<ul>
<li><a href="https://www.cyberciti.biz/faq/redhat-install-semanage-selinux-command-rpm/" target="_blank" rel="external">https://www.cyberciti.biz/faq/redhat-install-semanage-selinux-command-rpm/</a></li>
<li><a href="http://sharadchhetri.com/2014/10/07/semanage-command-found-centos-7-rhel-7/" target="_blank" rel="external">http://sharadchhetri.com/2014/10/07/semanage-command-found-centos-7-rhel-7/</a></li>
</ul>
</blockquote>
<p>百度到的相关Selinux资料：</p>
<blockquote>
<p><a href="http://os.51cto.com/art/201105/265956.htm" target="_blank" rel="external">selinux入门</a><br><a href="http://www.hpboys.com/824.html" target="_blank" rel="external">Centos看Selinux状态</a></p>
</blockquote>
<h1 id="nodebb插件安装"><a href="#nodebb插件安装" class="headerlink" title="nodebb插件安装"></a>nodebb插件安装</h1><p>因为方便用户登录，使用了第三方登录插件和安全插件(防垃圾帖子和机器注册)</p>
<ol>
<li>直接在后台按照</li>
<li>在nodebb根目录下 npm install &lt;你需要的插件&gt;<blockquote>
<p>相关插件可以在npm，GitHub上寻找，也可以在nodebb插件市场上找</p>
</blockquote>
</li>
</ol>
<h1 id="将来可能出现的问题"><a href="#将来可能出现的问题" class="headerlink" title="将来可能出现的问题"></a>将来可能出现的问题</h1><blockquote>
<p>这次是这几年来，工作室第一次使用Linux服务器，从技术上，人员上是个挑战。</p>
</blockquote>
<ol>
<li>安全问题<br>工作室防服务器是学校的虚拟机，是对外，为用户服务的,Linux服务器如何管理，如何保证安全是一个问题。现在<strong>https</strong>越来越普遍，工作室也应该尽快进入https阶段了</li>
<li>性能问题<br>这个服务器配置不太好，将来很有可能出现性能瓶颈，如何和网络中心协商升级服务器</li>
<li>后期维护问题<br>这个nodebb采用的nodeJS+redis技术，后面的人才培养，进行二次开发，也是个挑战</li>
</ol>
<h1 id="链接收集："><a href="#链接收集：" class="headerlink" title="链接收集："></a>链接收集：</h1><p>工作室：<br><a href="http://forum.flyingstudio.online/" target="_blank" rel="external">工作室内部论坛FlyingForum</a><br><a href="http://wiki.flyingstudio.online/" target="_blank" rel="external">工作室wiki</a><br>Node相关：<br><a href="https://nodejs.org/en/download/package-manager/" target="_blank" rel="external">Nodejs官方包管理器安装方法</a><br>Nginx相关：<br>[Nginx下载安装教程] (<a href="http://nginx.org/en/linux_packages.html#stable" target="_blank" rel="external">http://nginx.org/en/linux_packages.html#stable</a>)<br>MongoDB：<br><a href="https://docs.mongodb.com/manual/tutorial/install-mongodb-on-red-hat/" target="_blank" rel="external">mongodb”centos”官方安装教程</a><br>Redis相关：<br><a href="https://redis.io/download" target="_blank" rel="external">Redis官方下载</a><br><a href="https://linux.cn/article-6719-1.html" target="_blank" rel="external">CentOS 7 上安装 Redis 服务器</a><br><a href="https://segmentfault.com/a/1190000002685224" target="_blank" rel="external">centos6安装redis</a><br>NodeBB相关：<br><a href="https://docs.nodebb.org/en/latest/installing/os/centos.html" target="_blank" rel="external">官方安装教程</a><br><a href="https://docs.nodebb.org/en/latest/configuring/proxies/nginx.html" target="_blank" rel="external">Nodebb官方Nginx配置</a><br>SELinux相关：<br><a href="http://os.51cto.com/art/201105/265956.htm" target="_blank" rel="external">selinux入门</a><br><a href="http://www.hpboys.com/824.html" target="_blank" rel="external">Centos看Selinux状态</a></p>

      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/学习/" rel="tag"># 学习</a>
          
            <a href="/tags/Linux/" rel="tag"># Linux</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/12/20/点石成金读书笔记/" rel="next" title="点石成金读书笔记">
                <i class="fa fa-chevron-left"></i> 点石成金读书笔记
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/01/03/2017/" rel="prev" title="2016，2017">
                2016，2017 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">seven-zsyzzx</p>
              <p class="site-description motion-element" itemprop="description">个人博客,记录自己</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">18</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">8</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">16</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/rss2.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          

          
            
          
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#工作室内部论坛FlyingForum"><span class="nav-number">1.</span> <span class="nav-text">工作室内部论坛FlyingForum</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#为什么使用nodebb"><span class="nav-number">2.</span> <span class="nav-text">为什么使用nodebb</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#准备"><span class="nav-number">3.</span> <span class="nav-text">准备</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#安装Node"><span class="nav-number">3.0.1.</span> <span class="nav-text">安装Node</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#安装Nginx"><span class="nav-number">3.0.2.</span> <span class="nav-text">安装Nginx</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#安装Git-root下yum安装"><span class="nav-number">3.0.3.</span> <span class="nav-text">安装Git root下yum安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#安装redis3-2-6"><span class="nav-number">3.0.4.</span> <span class="nav-text">安装redis3.2.6</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#开始安装Nodebb"><span class="nav-number">4.</span> <span class="nav-text">开始安装Nodebb</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-下载Nodebb到相应的目录"><span class="nav-number">4.0.1.</span> <span class="nav-text">1.  下载Nodebb到相应的目录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-参照官方教程安装NodeBB"><span class="nav-number">4.0.2.</span> <span class="nav-text">2. 参照官方教程安装NodeBB</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-安装完成后，启动NodeBB"><span class="nav-number">4.0.3.</span> <span class="nav-text">3. 安装完成后，启动NodeBB</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-设置nginx"><span class="nav-number">4.0.4.</span> <span class="nav-text">4. 设置nginx</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#问题解决-SElinux导致Nginx转发失败"><span class="nav-number">5.</span> <span class="nav-text">问题解决  SElinux导致Nginx转发失败</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#nodebb插件安装"><span class="nav-number">6.</span> <span class="nav-text">nodebb插件安装</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#将来可能出现的问题"><span class="nav-number">7.</span> <span class="nav-text">将来可能出现的问题</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#链接收集："><span class="nav-number">8.</span> <span class="nav-text">链接收集：</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">seven-zsyzzx</span>

  

  
</div>




  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动 v3.2.2</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Muse</a> v6.1.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.1.0"></script>



  



	





  





  










  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("XSuHXMUAW7oym6yPOYfHuMtD-gzGzoHsz", "nfGfdjsnnKMAjF6ub666NVDA");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            
            counter.save(null, {
              success: function(counter) {
                
                  var $element = $(document.getElementById(url));
                  $element.find('.leancloud-visitors-count').text(counter.get('time'));
                
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            
              var $element = $(document.getElementById(url));
              $element.find('.leancloud-visitors-count').text('Counter not initialized! See more at console err msg.');
              console.error('ATTENTION! LeanCloud counter has security bug, see here how to solve it: https://github.com/theme-next/hexo-leancloud-counter-security. \n But you also can use LeanCloud without security, by set \'security\' option to \'false\'.');
            
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  

  
  

  

  

  

  

</body>
</html>
